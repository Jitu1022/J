<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JITU | Free Notes & Video Lectures</title>
    
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --pw-blue: #5a4bda; --bg: #f8f9fd; }
        body { font-family: 'Outfit', sans-serif; background-color: var(--bg); color: #1e2937; margin: 0; scroll-behavior: smooth; }
        
        h1, h2, h3, h4, span, p, button { font-weight: 500 !important; }
        .font-bold { font-weight: 500 !important; }

        .platform-card { border: 2px solid #eef2f6; background: white; transition: 0.3s; cursor: pointer; border-radius: 20px; }
        .platform-card.active { border-color: var(--pw-blue); background: #f5f3ff; transform: translateY(-3px); }
        
        .sub-pill { border: 2px solid #e2e8f0; background: #ffffff; color: #475569; border-radius: 12px; transition: 0.2s; }
        .sub-pill.active { background: var(--pw-blue); color: white; border-color: var(--pw-blue); }

        .chapter-accordion { background: white; border: 1px solid #eef2f6; border-radius: 24px; margin-bottom: 1rem; overflow: hidden; }
        .chapter-header { padding: 1.2rem; cursor: pointer; display: flex; align-items: flex-start; justify-content: space-between; gap: 12px; }
        .chapter-content { display: none; padding: 0 1.2rem 1.2rem; border-top: 1px solid #f8fafc; }
        .chapter-accordion.open .chapter-content { display: block; }
        
        #globalLoader { position: fixed; inset: 0; background: #ffffff; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { width: 40px; height: 40px; border: 3px solid #f3f3f3; border-top: 3px solid var(--pw-blue); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .footer-card { background: white; border: 1px solid #eef2f6; border-radius: 2rem; padding: 2.5rem; margin-bottom: 2rem; }
        .hero-gradient { background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%); }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* REDIRECT POPUP STYLES */
        #redirect-overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); display: flex; align-items: center; justify-content: center; z-index: 10001; }
        .redirect-card { background: white; padding: 2.5rem; border-radius: 2.5rem; text-align: center; max-width: 380px; width: 90%; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        .timer-svg { width: 100px; height: 100px; transform: rotate(-90deg); }
        .timer-circle-bg { fill: none; stroke: #e2e8f0; stroke-width: 6; }
        .timer-circle-prog { fill: none; stroke: #4f46e5; stroke-width: 6; stroke-linecap: round; stroke-dasharray: 283; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear; }
        @keyframes rocket-float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .rocket-icon { animation: rocket-float 2s ease-in-out infinite; display: inline-block; font-size: 3rem; }
    </style>
</head>
<body>

<div id="redirect-overlay">
    <div class="redirect-card">
        <div class="rocket-icon mb-4">üöÄ</div>
        <h2 class="text-2xl font-bold text-gray-900 mb-2 uppercase tracking-tight">Nayi Website Live Hai!</h2>
        <p class="text-gray-500 text-[11px] font-medium mb-8 uppercase tracking-wide">Behtar experience ke liye hum shift ho rahe hain...</p>

        <div class="relative flex items-center justify-center mb-8">
            <svg class="timer-svg">
                <circle cx="50" cy="50" r="45" class="timer-circle-bg"></circle>
                <circle cx="50" cy="50" r="45" class="timer-circle-prog" id="timerBar"></circle>
            </svg>
            <div class="absolute flex flex-col items-center">
                <span id="countText" class="text-2xl font-bold text-indigo-600">5</span>
                <span class="text-[8px] font-bold text-gray-400 uppercase">Sec</span>
            </div>
        </div>

        <div class="space-y-3">
            <a href="https://notjitu.vercel.app" class="block w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold uppercase text-xs shadow-lg hover:scale-105 transition-transform">
                Abhi Chalein ‚Üí
            </a>
            <button onclick="document.getElementById('redirect-overlay').style.display='none'" class="text-gray-400 text-[9px] font-bold uppercase tracking-[0.2em] hover:text-indigo-500">
                Yahƒ´√± Rukei√±
            </button>
        </div>
    </div>
</div>

<div id="globalLoader">
    <div class="spinner"></div>
    <p class="mt-4 text-[10px] font-semibold uppercase tracking-widest text-indigo-600"> Wait ‚úãÔ∏è Website Is Loading...</p>
</div>

<header class="sticky top-0 z-50 bg-white/98 backdrop-blur-md border-b border-gray-100">
    <nav class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white font-bold shadow-lg">J</div>
            <div class="flex flex-col">
                <span class="text-sm font-semibold uppercase tracking-tight leading-none">JITU PREMIUM</span>
                <span class="text-[8px] font-bold text-indigo-500 uppercase mt-1">Education Vault</span>
            </div>
        </div>
        <div class="flex gap-2">
            <button id="addBtn" onclick="openAddModal()" class="hidden bg-green-600 text-white px-4 py-2 rounded-lg text-[10px] font-semibold">ADD CONTENT</button>
            <button id="adminBtn" onclick="openLoginModal()" class="bg-gray-100 text-gray-500 px-4 py-2 rounded-lg text-[10px] font-semibold">ADMIN</button>
        </div>
    </nav>
</header>

<section class="hero-gradient py-16 px-6 text-center text-white">
    <h1 class="text-3xl md:text-5xl font-semibold mb-4 uppercase leading-none">Class 11 & 12 Science <br>Free Study Materials ‚ò∫Ô∏è</h1>
    <p class="text-indigo-200 text-[10px] uppercase tracking-widest">Physics ‚Ä¢ Chemistry ‚Ä¢ Maths ‚Ä¢ Biology ‚Ä¢ English</p>
</section>

<div class="max-w-4xl mx-auto px-6 -mt-8 grid grid-cols-3 gap-3">
    <div id="plat-PW" onclick="selectPlatform('PW')" class="platform-card p-3 active text-center">
        <img src="https://i.ibb.co/7tTCGV81/download.png" class="w-12 h-12 mx-auto rounded-full mb-2 border-2 border-white shadow-sm">
        <span class="text-[9px] font-bold uppercase block">PW Project 45</span>
    </div>
    <div id="plat-NT" onclick="selectPlatform('NT')" class="platform-card p-3 text-center">
        <img src="https://i.ibb.co/ks97sGmS/download-1.png" class="w-12 h-12 mx-auto rounded-full mb-2 border-2 border-white shadow-sm">
        <span class="text-[9px] font-bold uppercase block">Class 11th Nirbhay batch</span>
    </div>
    <div id="plat-NT12" onclick="selectPlatform('NT12')" class="platform-card p-3 text-center">
        <img src="https://i.ibb.co/ks97sGmS/download-1.png" class="w-12 h-12 mx-auto rounded-full mb-2 border-2 border-white shadow-sm">
        <span class="text-[9px] font-bold uppercase block">Class 12th Nirbhay Batch</span>
    </div>
</div>

<div id="plannerWrapper" class="max-w-3xl mx-auto px-6 mt-8 hidden">
    <div class="bg-indigo-600 rounded-2xl p-4 flex items-center justify-between text-white shadow-lg">
        <div onclick="openPlanner()" class="flex items-center gap-3 cursor-pointer">
            <span class="text-2xl">üìÖ</span>
            <div>
                <h4 class="text-xs font-bold uppercase">Weekly Planner</h4>
                <p class="text-[9px] opacity-70 uppercase">Check targets & schedule</p>
            </div>
        </div>
        <button id="editPlannerBtn" onclick="openPlannerEdit()" class="hidden bg-yellow-400 text-black px-3 py-1 rounded-lg text-[8px] font-bold">EDIT</button>
    </div>
</div>

<div class="max-w-3xl mx-auto px-6 mt-8 overflow-x-auto flex gap-2 no-scrollbar" id="subjectList"></div>

<main class="max-w-3xl mx-auto px-6 py-10 min-h-screen">
    <input id="searchInput" type="text" placeholder="Search Lecture or Chapter..." class="w-full bg-white border-2 border-gray-100 px-6 py-4 rounded-2xl outline-none focus:border-indigo-500 mb-8 text-sm font-medium shadow-sm">
    
    <div id="verticalContent" class="space-y-4"></div>
    <div id="emptyState" class="text-center py-20 hidden text-gray-300 uppercase font-bold">No Content Found...</div>

    <div class="mt-40 space-y-16">
        <div id="about-us" class="footer-card">
            <h2 class="text-2xl font-bold uppercase text-indigo-900 mb-6 border-b-4 border-indigo-600 inline-block">About Us</h2>
            <p class="text-md text-gray-700 leading-relaxed font-medium">JITU VAULT ek educational platform hai jo specially Class 11 aur 12 Science ke students ko dhyan mein rakkar banaya gaya hai.</p>
        </div>

        <div id="contact-us" class="footer-card bg-indigo-50">
            <h2 class="text-2xl font-bold uppercase text-indigo-900 mb-6 border-b-4 border-indigo-600 inline-block">Contact Us</h2>
            <p class="text-md text-gray-700 leading-relaxed font-medium mb-8">Gmail - gajendrakushwah1027@gmail.com</p>
            <div class="flex flex-wrap gap-4">
                <a href="https://youtube.com/@notjitu1022" class="bg-red-600 text-white px-8 py-4 rounded-2xl text-[10px] font-bold uppercase shadow-lg">YouTube Support</a>
                <a href="https://www.instagram.com/notjitu_fz/" class="bg-purple-600 text-white px-8 py-4 rounded-2xl text-[10px] font-bold uppercase shadow-lg">Instagram</a>
            </div>
        </div>
    </div>
</main>

<div id="modalOverlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm hidden z-[100] items-center justify-center p-6 opacity-0 transition-all duration-300">
    <div id="downloadStepModal" class="bg-white rounded-[2.5rem] w-full max-w-md p-8 hidden shadow-2xl border-4 border-indigo-600">
        <div class="text-center">
            <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 font-bold text-2xl">‚úì</div>
            <h3 class="text-xl font-bold uppercase text-indigo-900 mb-2">Lecture Link Copied ‚úÖ</h3>
            <p class="text-gray-500 text-[10px] font-bold uppercase tracking-widest mb-6">Ab niche diye steps follow kareinüëá</p>
            <button onclick="window.open('https://m3u8.dev/', '_blank');closeModals()" class="w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold uppercase text-xs shadow-lg hover:scale-105 transition-transform">Go to m3u8.dev ‚Üí</button>
        </div>
    </div>

    <div id="renameModal" class="bg-white rounded-[2.5rem] w-full max-w-sm p-8 hidden">
        <h3 class="text-lg font-bold mb-4 uppercase text-center text-indigo-900">Rename Chapter</h3>
        <input id="newNameInput" type="text" class="w-full bg-gray-50 p-4 rounded-xl mb-6 border-2 border-gray-100 outline-none font-bold">
        <input type="hidden" id="oldNameStore">
        <button onclick="processRename()" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-bold uppercase text-xs">Update All Lectures</button>
    </div>

    <div id="loginModal" class="bg-white rounded-[2.5rem] w-full max-w-sm p-8 hidden text-center">
        <h3 class="text-xl font-bold mb-6 uppercase text-indigo-900 tracking-widest">Admin Access</h3>
        <input id="passInput" type="password" placeholder="Enter Passkey" class="w-full bg-gray-50 p-5 rounded-2xl mb-6 text-center text-xl font-bold border-2 border-gray-100 outline-none">
        <button onclick="tryLogin()" class="w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold uppercase text-xs">Verify</button>
    </div>

    <div id="playerModal" class="bg-black rounded-3xl w-full max-w-4xl overflow-hidden hidden relative">
        <video id="hlsVideo" controls autoplay playsinline class="w-full h-full aspect-video"></video>
        <button onclick="closeModals()" class="absolute top-4 right-4 bg-white/20 text-white p-2 rounded-full hover:bg-white/40">‚úï</button>
    </div>
</div>

<footer class="py-12 border-t border-gray-100 text-center">
    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-[0.3em]">¬© 2026 JITU EDUCATIONAL HUB</p>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, writeBatch, query, where, getDocs, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyB1bJg4JrtFmceuAZvJaMXgUUhxCf1UKdo",
  authDomain: "not-13c89.firebaseapp.com",
  projectId: "not-13c89",
  storageBucket: "not-13c89.firebasestorage.app",
  messagingSenderId: "684410233370",
  appId: "1:684410233370:web:0ed671c584120a4fc1a7a3"
};

let db, auth, videoList = [], isAdmin = false, currentSubject = '', currentPlatform = 'PW';
const PASS_KEY = "Jitu9027", COLLECTION_ID = "jitu_ultra_premium_v2";
const SUBJECT_ORDER = ["Physics", "Chemistry", "Maths", "Biology", "English"];
let hlsInstance = null;

// REDIRECT LOGIC
(function() {
    let timeLeft = 5;
    const countText = document.getElementById('countText');
    const timerBar = document.getElementById('timerBar');
    const totalDash = 283; 

    const redirectTimer = setInterval(() => {
        timeLeft--;
        if (countText) countText.innerText = timeLeft;
        if (timerBar) {
            const offset = totalDash - (timeLeft / 5) * totalDash;
            timerBar.style.strokeDashoffset = offset;
        }
        if (timeLeft <= 0) {
            clearInterval(redirectTimer);
            window.location.href = "https://notjitu.vercel.app";
        }
    }, 1000);
})();

async function startup() {
    const app = initializeApp(firebaseConfig);
    db = getFirestore(app); auth = getAuth(app);
    await signInAnonymously(auth);
    onAuthStateChanged(auth, user => { if(user) listen(); });
}

function listen() {
    onSnapshot(collection(db, 'artifacts', COLLECTION_ID, 'public', 'data', 'videos'), snap => {
        videoList = snap.docs.map(d => ({ id: d.id, ...d.data() }));
        if(videoList.length > 0 && !currentSubject) autoSelectSubject();
        document.getElementById('globalLoader')?.remove();
        render();
    });
}

function autoSelectSubject() {
    let platformVids = videoList.filter(v => (v.platform || 'PW') === currentPlatform);
    const availableSubs = [...new Set(platformVids.map(v => v.subject.charAt(0).toUpperCase() + v.subject.slice(1).toLowerCase()))];
    currentSubject = SUBJECT_ORDER.find(s => availableSubs.includes(s)) || availableSubs[0] || '';
}

window.render = () => {
    const subList = document.getElementById('subjectList');
    const verticalCont = document.getElementById('verticalContent');
    const search = document.getElementById('searchInput').value.toLowerCase();
    
    document.getElementById('plannerWrapper').classList.toggle('hidden', currentPlatform === 'PW');
    if (isAdmin) {
        document.getElementById('addBtn').classList.remove('hidden');
        document.getElementById('editPlannerBtn').classList.remove('hidden');
    }

    let platformVids = videoList.filter(v => (v.platform || 'PW') === currentPlatform);
    const uniqueSubs = [...new Set(platformVids.map(v => v.subject.charAt(0).toUpperCase() + v.subject.slice(1).toLowerCase()))].sort((a,b) => SUBJECT_ORDER.indexOf(a) - SUBJECT_ORDER.indexOf(b));
    
    subList.innerHTML = uniqueSubs.map(s => `<button onclick="selectSubject('${s}')" class="sub-pill px-5 py-2.5 text-[10px] font-bold uppercase whitespace-nowrap ${currentSubject.toLowerCase() === s.toLowerCase() ? 'active' : ''}">${s}</button>`).join('');

    const natSort = (a, b) => a.localeCompare(b, undefined, { numeric: true, sensitivity: 'base' });
    let subVideos = platformVids.filter(v => v.subject.toLowerCase() === currentSubject.toLowerCase() && v.title.toLowerCase().includes(search));
    subVideos.sort((a,b) => natSort(a.title, b.title));

    const chaptersMap = {};
    subVideos.forEach(v => {
        const cName = v.chapter || 'General Content';
        const key = cName.toLowerCase().trim();
        if(!chaptersMap[key]) chaptersMap[key] = { name: cName, items: [] };
        chaptersMap[key].items.push(v);
    });

    const sortedKeys = Object.keys(chaptersMap).sort(natSort);
    document.getElementById('emptyState').classList.toggle('hidden', subVideos.length > 0);

    verticalCont.innerHTML = sortedKeys.map((key, idx) => {
        const group = chaptersMap[key];
        const onePager = group.items.find(v => v.chapNotes)?.chapNotes;

        return `
            <div class="chapter-accordion" id="chap-${idx}">
                <div class="chapter-header" onclick="toggleChapter(event, ${idx})">
                    <div class="flex items-start gap-4 flex-1">
                        <span class="w-8 h-8 bg-indigo-50 text-indigo-600 rounded-lg flex items-center justify-center font-bold text-xs flex-shrink-0">${idx + 1}</span>
                        <div class="flex flex-col">
                            <span class="font-bold text-sm text-gray-800 uppercase leading-snug break-words">${group.name}</span>
                            ${isAdmin ? `<button onclick="openRenameModal('${group.name}')" class="mt-1 text-[8px] font-bold text-indigo-500 uppercase bg-indigo-50 px-2 py-1 rounded w-fit">Edit Name</button>` : ''}
                        </div>
                    </div>
                    <svg class="w-4 h-4 text-gray-400 mt-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7" stroke-width="3"></path></svg>
                </div>
                <div class="chapter-content">
                    <div class="space-y-3">
                        ${group.items.map(v => `
                            <div class="bg-gray-50 p-4 rounded-xl flex flex-col md:flex-row md:items-center justify-between gap-4">
                                <div class="flex-1">
                                    <span class="text-[11px] font-bold text-gray-700 uppercase block leading-tight">${v.title}</span>
                                </div>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="playVideo('${v.m3u8Url}')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-[9px] font-bold uppercase shadow-sm">Play</button>
                                    <button onclick="handleDownload('${v.m3u8Url}')" class="bg-green-600 text-white px-4 py-2 rounded-lg text-[9px] font-bold uppercase shadow-sm">Download</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }).join('');
};

window.handleDownload = (url) => {
    const temp = document.createElement("input");
    temp.value = url;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand("copy");
    document.body.removeChild(temp);
    showModal('downloadStepModal');
};

window.playVideo = (url) => {
    if(url.includes('.m3u8')) {
        const v = document.getElementById('hlsVideo');
        showModal('playerModal');
        if (hlsInstance) hlsInstance.destroy();
        if (Hls.isSupported()) {
            hlsInstance = new Hls();
            hlsInstance.loadSource(url);
            hlsInstance.attachMedia(v);
        } else { v.src = url; }
    } else window.open(url, '_blank');
};

window.selectPlatform = (p) => {
    currentPlatform = p;
    document.querySelectorAll('.platform-card').forEach(c => c.classList.remove('active'));
    document.getElementById(`plat-${p}`).classList.add('active');
    autoSelectSubject(); render();
};

window.toggleChapter = (e, idx) => { if(!e.target.closest('button')) document.getElementById(`chap-${idx}`).classList.toggle('open'); };
window.tryLogin = () => { if(document.getElementById('passInput').value === PASS_KEY) { isAdmin = true; closeModals(); render(); } };
window.selectSubject = (s) => { currentSubject = s; render(); };
window.showModal = (id) => { 
    const o = document.getElementById('modalOverlay'); 
    o.classList.remove('hidden'); o.classList.add('flex'); 
    document.getElementById(id).classList.remove('hidden'); 
    setTimeout(() => o.style.opacity = '1', 50); 
};
window.closeModals = () => { 
    const v = document.getElementById('hlsVideo'); if(v) v.pause();
    document.getElementById('modalOverlay').style.opacity = '0'; 
    setTimeout(() => {
        document.getElementById('modalOverlay').classList.add('hidden');
        ['loginModal','playerModal','renameModal','downloadStepModal'].forEach(m => document.getElementById(m).classList.add('hidden'));
    }, 300); 
};
window.openLoginModal = () => isAdmin ? (isAdmin = false, location.reload()) : showModal('loginModal');
document.getElementById('searchInput').addEventListener('input', render);
startup();
</script>
</body> 
    </html>
